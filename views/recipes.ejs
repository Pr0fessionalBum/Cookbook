<%- include('partials/header') %>

<div class="recipes-container">
    <h1>Recipe Collection</h1>

    <div class="search-section">
        <input type="text" id="recipe-search" placeholder="Search recipes...">
    </div>

    <div class="recipes-grid">
        <% Object.entries(categorizedRecipes).forEach(([category, recipes]) => { %>
            <% if (recipes.length > 0) { %>
                <div class="category-section" data-category="<%= category %>">
                    <h2 class="category-title">
                        <%= category.charAt(0).toUpperCase() + category.slice(1) %> Recipes
                        <span class="recipe-count">(<%= recipes.length %>)</span>
                    </h2>
                    <div class="recipe-cards">
                        <% recipes.forEach(recipe => { %>
                            <div class="recipe-card" data-recipe-name="<%= recipe.name.toLowerCase() %>">
                                <h3><%= recipe.name %></h3>
                                <div class="recipe-ingredients">
                                    <p>
                                        <% if (recipe.ingredients && recipe.ingredients.length > 0) { %>
                                            <%= recipe.ingredients.map(i => i.name).join(', ') %>
                                        <% } else { %>
                                            No ingredients listed
                                        <% } %>
                                    </p>
                                </div>
                                <a href="/recipe/<%= recipe.id %>" class="view-recipe-btn">View Recipe</a>
                            </div>
                        <% }) %>
                    </div>
                </div>
            <% } %>
        <% }) %>
    </div>
</div>

<style>
.recipes-container {
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
}

.search-section {
    margin-bottom: 30px;
}

#recipe-search {
    width: 100%;
    padding: 10px;
    font-size: 16px;
    border: 2px solid #ddd;
    border-radius: 4px;
}

.category-section {
    margin-bottom: 40px;
}

.category-title {
    border-bottom: 2px solid #333;
    padding-bottom: 10px;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.recipe-count {
    font-size: 0.8em;
    color: #666;
}

.recipe-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
}

.recipe-card {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.recipe-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.recipe-card h3 {
    margin: 0 0 10px 0;
    color: #333;
}

.recipe-ingredients {
    font-size: 0.9em;
    color: #666;
    margin-bottom: 15px;
}

.view-recipe-btn {
    display: inline-block;
    padding: 8px 16px;
    background-color: #333;
    color: white;
    text-decoration: none;
    border-radius: 4px;
    transition: background-color 0.3s;
}

.view-recipe-btn:hover {
    background-color: #444;
}
</style>

<script>
document.getElementById('recipe-search').addEventListener('input', function(e) {
    const searchTerm = e.target.value.toLowerCase();
    const recipeCards = document.querySelectorAll('.recipe-card');
    
    recipeCards.forEach(card => {
        const recipeName = card.dataset.recipeName;
        const isVisible = recipeName.includes(searchTerm);
        card.style.display = isVisible ? 'block' : 'none';
    });

    // Update category visibility
    document.querySelectorAll('.category-section').forEach(section => {
        const visibleCards = section.querySelectorAll('.recipe-card[style="display: block"]');
        section.style.display = visibleCards.length > 0 ? 'block' : 'none';
    });
});
</script>

<%- include('partials/footer') %>